# 需求

第一目标：自助平台，零运维。

## Manager

### 账户

- Manager开放公网访问，支持多种认证方式
  - 用户名限制暂时限制为邮箱，支持自动选择所在企业
  - 用户ID全局唯一，自动增长
- 不实现用户系统，依赖第三方用户系统，只引用用户名
- 第三方用户系统需要提供认证接口
  - Restful
  - LDAP (二期实现)
  - AD (二期实现)
- 注册一个企业
  1. 超级管理员才添加
  1. 名称
  1. 邮箱域名

### 部署

- Manager部署单个实例，管理多个环境
- 企业
  - gateway域名
    1. dev-pay.apis.ltd
    1. sit-pay.apis.ltd
    1. pre-pay.apis.ltd
    1. pay.apis.ltd
    1. 注册账户验证接口
  1. 配置业务线，多个gateway实例（http[s]://127.0.0.1:8001）

### 权限

- API可见性。api分组为权限分割的最小单元。
- 权限范围
  - 相同组(private, default)
  - 相同企业(protect)
  - 所有(public)
- api权限分为
  - 可读
  - 可写
- 用户默认只能查看公开的API和自己所在组的API
- 创建分组的用户拥有当前分组的管理员权限，可添加其他成员

### 功能

- 支持插件系统
- 拥有工单系统(二期实现)

### 动态配置虚拟服务器

二期实现

### 文档

二期实现，暂时使用第三方文档系统

### 审计日志

二期实现

### SDK

二期实现

## Gateway

- 兼容性
  - application/vnd.resthub.v1+json
  - application/vnd.resthub.v2+json
  - application/vnd.resthub.v3+json
- 每个Gateway实例通过自动生成的二级域名可以访问
- 动态修改upstream配置 (二期实现)
- Resthub-Spec为必选header信息
- gateway支持多环境部署（dev、sit、pre、pro）
- gateway支持多机房部署（不同公司主体）
- gateway支持自定义域名(自动生成)访问
- 转发请求时，只修改uri和header，其他部分默认不做修改
- 常量参数：用户自定义
- 系统参数：上游nginx的ip地址，当前nginx的ip地址，客户端ip地址，request-id